function Shizzle(e,t,a){"use strict";function i(){l(),n(),o(),s(),u(),h()}function l(){w.on("keyup change",function(e){g.filteredItems.length=0,b.empty(),_.forEach(g.items,function(t){t[C].toLowerCase().indexOf(e.target.value.toLowerCase())>-1&&f(t)}),d(g.filteredItems)})}function n(){w.on("keypress",function(e){b.not(":visible")&&b.show()})}function o(){$(document).click(function(){b.hide()})}function s(){w.click(function(e){e.stopPropagation(),b.toggle()})}function u(){$(document).on("click","#shizzle-container-"+e+" .sz-choices li",function(){g.selectedItem={value:$(this).data("value"),text:$(this).text(),value2:$(this).attr("data-value-2"),value3:$(this).attr("data-value-3"),value4:$(this).attr("data-value-4")},w.val(""),w.focus(),b.toggle(),g.addPill(g.selectedItem),P&&P()})}function r(e){if(e){if(!e.dataValue)throw new Error("dataValue is required");if(!e.dataText)throw new Error("displayText is required");E=e.dataValue,C=e.dataText,I=e.dataValue2,V=e.dataValue3,B=e.dataValue4}}function c(e,t){var a=document.createElement("div");a.id="shizzle-container-"+t,a.className="shizzlex",a.innerHTML="<ul class='shizzlex sz-pills'><li class='sz-search-box-container'><input type='text' search-box placeholder=\""+H+"\" class='sz-search-box' style='width: 100%; border: 0; outline: none; box-shadow: 0 0 0 #fff !important; -webkit-box-shadow: 0 0 0 #fff !important;'/></li></ul><ul class='shizzlex sz-choices'></ul>",p(a,e)}function d(e){if(e){b.empty();var t=_.uniqBy(e,E);_.forEach(t,function(e){b.append("<li data-value='"+e[E]+"' data-value-2='"+e[I]+"' data-value-3='"+e[V]+"' data-value-4='"+e[B]+"'>"+e[C]+"</li>")})}}function h(){$(document).on("click","#shizzle-container-"+e+" .sz-pills li",function(e){var t={};t[E]=$(this).data("value"),t[C]=$(this).data("text"),t[I]=$(this).attr("data-value-2"),t[V]=$(this).attr("data-value-3"),t[B]=$(this).attr("data-value-4");var a=!0;$.isFunction(W)?W(t):a=W,a&&g.items.push(t),_.remove(g.pills,function(e){return e.value===t[E]}),$('[data-value="'+t[E]+'"]').remove(),d(_.sortBy(g.items,["text"])),w.focus(),F&&v(),q&&q()})}function f(e){var t=!1;_.forEach(g.filteredItems,function(a){a[E]===e[E]&&(t=!0)}),t||g.filteredItems.push(e)}function p(e,t){t.parentNode.insertBefore(e,t.nextSibling)}function v(){D&&(F=!0,0===g.pills.length?(g.$pillContainer.addClass(M),N&&m()):g.$pillContainer.removeClass(M))}function z(){var t=document.createElement("span");t.className="shizzlex sz-validation-message "+O,t.innerText=R,t.style.display="none",p(t,document.getElementById("shizzle-container-"+e))}function m(){$("."+O).show()}function x(){$("."+O).hide()}function y(e,t){var a=!1;return _.forEach(e,function(e){e.value.toLowerCase()===t.value.toLowerCase()&&(a=!0)}),a}var g=this,e=e,w=null,b=null,S=null,C=null,E=null,I=null,V=null,B=null,L=null,T=!1,k=!1,P=null,q=null,A=null,D=!1,M=null,N=!1,O=null,R=null,F=!1,H="",W=!0;g.dataSource=null,g.items=[],g.filteredItems=[],g.pills=[],g.$pillContainer=null,function(){if(!e)throw new Error("id is required");if(!t)throw new Error("dataFields are required");r(t),a&&(L=a.data||null,T=a.itemsVisibleOnPageLoad||!1,P=a.onItemSelected||null,q=a.onPillRemoved||null,A=a.onItemsCleared||null,k=a.setToFocusOnPageLoad||!1,M=a.fieldErrorCss||null,D=a.isRequired||null,N=a.showValidationMessage||!1,O=a.validationMessageCss||null,R=a.validationMessageText||null,H=a.placeholder||"",W=a.shouldRepopulateOnRemove||!0),g.dataSource=_.sortBy(L,["text"]),g.items=_.cloneDeep(g.dataSource),c(document.getElementById(e),e),b=$("#shizzle-container-"+e).find(".sz-choices"),w=$("#shizzle-container-"+e).find("[search-box]"),g.$pillContainer=$("#shizzle-container-"+e).find(".sz-pills"),D&&N&&z(),T?b.show():b.hide(),k&&w.focus(),g.items&&d(g.items),i()}(),this.addPill=function(t){if(!y(g.pills,t)){g.pills.push(t);var a=document.createElement("li");a.setAttribute("data-id",t.id),a.setAttribute("data-text",t.text),a.setAttribute("data-value",t.value),a.setAttribute("data-value-2",t.value2),a.setAttribute("data-value-3",t.value3),a.setAttribute("data-value-4",t.value4),a.className="sz-pill",a.innerHTML="<span>"+t.text+"</span><span class='sz-close sz-hairline'></span>",$(a).insertBefore($("#shizzle-container-"+e).find("[search-box]").parent()),S=$("#shizzle-container-"+e).find(".sz-pill"),_.remove(g.items,function(e){return e[E]===t.value}),F&&v(),D&&N&&x(),d(g.items)}},this.clearData=function(){g.dataSource=null,g.items=null,g.pills.length=0,g.filteredItems.length=0,w.val(""),b.empty(),b.hide(),S&&S.remove(),A&&A()},this.populateWithData=function(e){g.dataSource=_.sortBy(e,["text"]),g.items=_.cloneDeep(g.dataSource),d(g.items)},this.validateControl=function(){v()}}Shizzle.prototype.getSelectedItems=function(){return this.pills},Shizzle.prototype.setSelectedItems=function(e){var t=this;_.forEach(e,function(e){t.addPill(e)})},Shizzle.prototype.clear=function(){this.clearData()},Shizzle.prototype.populate=function(e){this.populateWithData(e)},Shizzle.prototype.isValid=function(){return 0!==this.pills.length},Shizzle.prototype.fireValidation=function(){console.warn("fireValidation is deprecated since version 1.1.0 . Use validate() instead."),this.validateControl()},Shizzle.prototype.validate=function(){this.validateControl()};