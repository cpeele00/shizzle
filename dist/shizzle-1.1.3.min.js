function Shizzle(e,t,l){function a(){i(),n(),o(),s(),u(),h()}function i(){y.on("keyup change",function(e){g.filteredItems.length=0,w.empty(),_.forEach(g.items,function(t){t[S].toLowerCase().indexOf(e.target.value.toLowerCase())>-1&&f(t)}),d(g.filteredItems)})}function n(){y.on("keypress",function(e){w.not(":visible")&&w.show()})}function o(){$(document).click(function(){w.hide()})}function s(){y.click(function(e){e.stopPropagation(),w.toggle()})}function u(){$(document).on("click","#shizzle-container-"+e+" .sz-choices li",function(){g.selectedItem={value:$(this).data("value"),text:$(this).text(),value2:$(this).attr("data-value-2"),value3:$(this).attr("data-value-3"),value4:$(this).attr("data-value-4")},y.val(""),y.focus(),w.toggle(),g.addPill(g.selectedItem),P&&P()})}function r(e){if(e){if(!e.dataValue)throw new Error("dataValue is required");if(!e.dataText)throw new Error("displayText is required");C=e.dataValue,S=e.dataText,E=e.dataValue2,I=e.dataValue3,V=e.dataValue4}}function c(e,t){var l=document.createElement("div");l.id="shizzle-container-"+t,l.className="shizzlex",l.innerHTML="<ul class='shizzlex sz-pills'><li class='sz-search-box-container'><input type='text' search-box placeholder=\""+F+"\" class='sz-search-box' style='width: 100%; border: 0; outline: none; box-shadow: 0 0 0 #fff !important; -webkit-box-shadow: 0 0 0 #fff !important;'/></li></ul><ul class='shizzlex sz-choices'></ul>",p(l,e)}function d(e){e&&(w.empty(),_.forEach(e,function(e){w.append("<li data-value='"+e[C]+"' data-value-2='"+e[E]+"' data-value-3='"+e[I]+"' data-value-4='"+e[V]+"'>"+e[S]+"</li>")}))}function h(){$(document).on("click","#shizzle-container-"+e+" .sz-pills li",function(e){var t={};t[C]=$(this).data("value"),t[S]=$(this).data("text"),t[E]=$(this).attr("data-value-2"),t[I]=$(this).attr("data-value-3"),t[V]=$(this).attr("data-value-4");var l=!0;$.isFunction(H)?H(t):l=H,l&&g.items.push(t),_.remove(g.pills,function(e){return e.value===t[C]}),$('[data-value="'+t[C]+'"]').remove(),d(_.sortBy(g.items,["text"])),y.focus(),R&&v(),A&&A()})}function f(e){var t=!1;_.forEach(g.filteredItems,function(l){l[C]===e[C]&&(t=!0)}),t||g.filteredItems.push(e)}function p(e,t){t.parentNode.insertBefore(e,t.nextSibling)}function v(){L&&(R=!0,0===g.pills.length?(g.$pillContainer.addClass(q),M&&m()):g.$pillContainer.removeClass(q))}function z(){var t=document.createElement("span");t.className="shizzlex sz-validation-message "+N,t.innerText=O,t.style.display="none",p(t,document.getElementById("shizzle-container-"+e))}function m(){$("."+N).show()}function x(){$("."+N).hide()}var g=this,e=e,y=null,w=null,b=null,S=null,C=null,E=null,I=null,V=null,T=null,k=!1,B=!1,P=null,A=null,D=null,L=!1,q=null,M=!1,N=null,O=null,R=!1,F="",H=!0;g.dataSource=null,g.items=[],g.filteredItems=[],g.pills=[],g.$pillContainer=null,function(){if(!e)throw new Error("id is required");if(!t)throw new Error("dataFields are required");r(t),l&&(T=l.data||null,k=l.itemsVisibleOnPageLoad||!1,P=l.onItemSelected||null,A=l.onPillRemoved||null,D=l.onItemsCleared||null,B=l.setToFocusOnPageLoad||!1,q=l.fieldErrorCss||null,L=l.isRequired||null,M=l.showValidationMessage||!1,N=l.validationMessageCss||nulll,O=l.validationMessageText||null,F=l.placeholder||"",H=l.shouldRepopulateOnRemove||!0),g.dataSource=_.sortBy(T,["text"]),g.items=_.cloneDeep(g.dataSource),c(document.getElementById(e),e),w=$("#shizzle-container-"+e).find(".sz-choices"),y=$("#shizzle-container-"+e).find("[search-box]"),g.$pillContainer=$("#shizzle-container-"+e).find(".sz-pills"),L&&M&&z(),k?w.show():w.hide(),B&&y.focus(),g.items&&d(g.items),a()}(),this.addPill=function(t){g.pills.push(t);var l=document.createElement("li");l.setAttribute("data-id",t.id),l.setAttribute("data-text",t.text),l.setAttribute("data-value",t.value),l.setAttribute("data-value-2",t.value2),l.setAttribute("data-value-3",t.value3),l.setAttribute("data-value-4",t.value4),l.className="sz-pill",l.innerHTML="<span>"+t.text+"</span><span class='sz-close sz-hairline'></span>",$(l).insertBefore($("#shizzle-container-"+e).find("[search-box]").parent()),b=$("#shizzle-container-"+e).find(".sz-pill"),_.remove(g.items,function(e){return e[C]===t.value}),R&&v(),L&&M&&x(),d(g.items)},this.clearData=function(){g.dataSource=null,g.items=null,g.pills.length=0,g.filteredItems.length=0,y.val(""),w.empty(),w.hide(),b&&b.remove(),D&&D()},this.populateWithData=function(e){g.dataSource=_.sortBy(e,["text"]),g.items=_.cloneDeep(g.dataSource),d(g.items)},this.validateControl=function(){v()}}Shizzle.prototype.getSelectedItems=function(){return this.pills},Shizzle.prototype.setSelectedItems=function(e){var t=this;_.forEach(e,function(e){t.addPill(e)})},Shizzle.prototype.clear=function(){this.clearData()},Shizzle.prototype.populate=function(e){this.populateWithData(e)},Shizzle.prototype.isValid=function(){return 0!==this.pills.length},Shizzle.prototype.fireValidation=function(){console.warn("fireValidation is deprecated since version 1.1.0 . Use validate() instead."),this.validateControl()},Shizzle.prototype.validate=function(){this.validateControl()};