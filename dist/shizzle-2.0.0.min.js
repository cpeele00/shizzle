function Shizzle(e, t, i) { "use strict"; function a() { l(), n(), o(), s(), u(), f() } function l() { w.on("keyup change", function (e) { y.filteredItems.length = 0, b.empty(), _.forEach(y.items, function (t) { t && t[E] && t[I] && t[E].toLowerCase().indexOf(e.target.value.toLowerCase()) > -1 && v(t) }), h(y.filteredItems) }) } function n() { w.on("keypress", function (e) { b.not(":visible") && b.show() }) } function o() { $(document).click(function () { b.hide() }) } function s() { w.click(function (e) { e.stopPropagation(), b.toggle() }) } function u() { $(document).on("click", "#shizzle-container-" + e + " .sz-choices li", function () { y.selectedItem = { value: $(this).data("value"), text: $(this).text(), value2: $(this).attr("data-value-2"), value3: $(this).attr("data-value-3"), value4: $(this).attr("data-value-4") }, w.val(""), w.focus(), b.toggle(), y.addPill(y.selectedItem), _.remove(y.items, function (e) { return e.id === y.selectedItem.value.toString() }), y.items && h(y.items), q && q() }) } function r(e) { if (e && 0 !== e.length) { var t = []; return _.forEach(e, function (e) { e && e[E] && e[I] && t.push(e) }), t } } function c(e) { if (e) { if (!e.dataValue) throw new Error("dataValue is required"); if (!e.dataText) throw new Error("displayText is required"); I = e.dataValue, E = e.dataText, V = e.dataValue2, B = e.dataValue3, L = e.dataValue4 } } function d(e, t) { var i = document.createElement("div"); i.id = "shizzle-container-" + t, i.className = "shizzlex", i.innerHTML = "<ul class='shizzlex sz-pills'><li class='sz-search-box-container'><input type='text' search-box placeholder=\"" + W + "\" class='sz-search-box' style='width: 100%; border: 0; outline: none; box-shadow: 0 0 0 #fff !important; -webkit-box-shadow: 0 0 0 #fff !important;'/></li></ul><ul class='shizzlex sz-choices'></ul>", p(i, e) } function h(e) { if (e) { b.empty(); var t = r(e), i = _.uniqBy(t, I.toString()); _.forEach(i, function (e) { e && e[I] && e[E] && b.append("<li data-value='" + e[I] + "' data-value-2='" + e[V] + "' data-value-3='" + e[B] + "' data-value-4='" + e[L] + "'>" + e[E] + "</li>") }) } } function f() { $(document).on("click", "#shizzle-container-" + e + " .sz-pills li", function (e) { var t = {}; t[I] = $(this).data("value").toString(), t[E] = $(this).data("text"), t[V] = $(this).attr("data-value-2"), t[B] = $(this).attr("data-value-3"), t[L] = $(this).attr("data-value-4"); var i = !0; $.isFunction(U) ? U(t) : i = U, i && y.items.push(t), _.remove(y.pills, function (e) { return e.value.toString() === t[I] }), $('[data-value="' + t[I] + '"]').remove(), h(_.sortBy(y.items, ["text"])), w.focus(), H && m(), A && A() }) } function v(e) { var t = !1; _.forEach(y.filteredItems, function (i) { i[I] === e[I] && (t = !0) }), t || y.filteredItems.push(e) } function p(e, t) { t.parentNode.insertBefore(e, t.nextSibling) } function m() { M && (H = !0, 0 === y.pills.length ? (y.$pillContainer.addClass(N), O && g()) : y.$pillContainer.removeClass(N)) } function z() { var t = document.createElement("span"); t.className = "shizzlex sz-validation-message " + R, t.innerText = F, t.style.display = "none", p(t, document.getElementById("shizzle-container-" + e)) } function g() { $("." + R).show() } function x() { $("." + R).hide() } function S(e, t) { var i = !1; if (t && t.value) return _.forEach(e, function (e) { e && e.value && (_.isString(e.value) ? e.value.toLowerCase() : e.value) === (_.isString(t.value) ? t.value.toLowerCase() : t.value) && (i = !0) }), i } var y = this, e = e, w = null, b = null, C = null, E = null, I = null, V = null, B = null, L = null, T = null, k = !1, P = !1, q = null, A = null, D = null, M = !1, N = null, O = !1, R = null, F = null, H = !1, W = "", U = !0; y.dataSource = null, y.items = [], y.filteredItems = [], y.pills = [], y.$pillContainer = null, function () { if (!e) throw new Error("id is required"); if (!t) throw new Error("dataFields are required"); c(t), i && (T = i.data || null, k = i.itemsVisibleOnPageLoad || !1, q = i.onItemSelected || null, A = i.onPillRemoved || null, D = i.onItemsCleared || null, P = i.setToFocusOnPageLoad || !1, N = i.fieldErrorCss || null, M = i.isRequired || null, O = i.showValidationMessage || !1, R = i.validationMessageCss || null, F = i.validationMessageText || null, W = i.placeholder || "", U = i.shouldRepopulateOnRemove || !0), y.dataSource = _.sortBy(T, ["text"]); var l = _.cloneDeep(y.dataSource); y.items = r(l), d(document.getElementById(e), e), b = $("#shizzle-container-" + e).find(".sz-choices"), w = $("#shizzle-container-" + e).find("[search-box]"), y.$pillContainer = $("#shizzle-container-" + e).find(".sz-pills"), M && O && z(), k ? b.show() : b.hide(), P && w.focus(), y.items && h(y.items), a() }(), this.addPill = function (t) { if (t && t.value && t.text && !S(y.pills, t)) { y.pills.push(t); var i = document.createElement("li"); i.setAttribute("data-id", t.id), i.setAttribute("data-text", t.text), i.setAttribute("data-value", t.value), i.setAttribute("data-value-2", t.value2), i.setAttribute("data-value-3", t.value3), i.setAttribute("data-value-4", t.value4), i.className = "sz-pill", i.innerHTML = "<span>" + t.text + "</span><span class='sz-close sz-hairline'></span>", $(i).insertBefore($("#shizzle-container-" + e).find("[search-box]").parent()), C = $("#shizzle-container-" + e).find(".sz-pill"), _.remove(y.items, function (e) { return e[I] === t.value }), H && m(), M && O && x(), h(y.items) } }, this.clearData = function () { y.dataSource = null, y.items = null, y.pills.length = 0, y.filteredItems.length = 0, w.val(""), b.empty(), b.hide(), C && C.remove(), D && D() }, this.populateWithData = function (e) { y.dataSource = _.sortBy(e, ["text"]), y.items = _.cloneDeep(y.dataSource), h(y.items) }, this.validateControl = function () { m() } } Shizzle.prototype.getSelectedItems = function () { return this.pills }, Shizzle.prototype.setSelectedItems = function (e) { var t = this; _.forEach(e, function (e) { t.addPill(e) }) }, Shizzle.prototype.clear = function () { this.clearData() }, Shizzle.prototype.populate = function (e) { this.populateWithData(e) }, Shizzle.prototype.isValid = function () { return 0 !== this.pills.length }, Shizzle.prototype.fireValidation = function () { console.warn("fireValidation is deprecated since version 1.1.0 . Use validate() instead."), this.validateControl() }, Shizzle.prototype.validate = function () { this.validateControl() };