function Shizzle(e,t,l){function i(){a(),n(),s(),o(),u(),h()}function a(){y.on("keyup change",function(e){g.filteredItems.length=0,S.empty(),_.forEach(g.items,function(t){t[C].toLowerCase().indexOf(e.target.value.toLowerCase())>-1&&f(t)}),d(g.filteredItems)})}function n(){y.on("keypress",function(e){S.not(":visible")&&S.show()})}function s(){$(document).click(function(){S.hide()})}function o(){y.click(function(e){e.stopPropagation(),S.toggle()})}function u(){$(document).on("click","#shizzle-container-"+e+" .sz-choices li",function(){g.selectedItem={value:$(this).data("value"),text:$(this).text(),value2:$(this).attr("data-value-2"),value3:$(this).attr("data-value-3"),value4:$(this).attr("data-value-4")},y.val(""),y.focus(),S.toggle(),g.addPill(g.selectedItem),P&&P()})}function r(e){if(e){if(!e.dataValue)throw new Error("dataValue is required");if(!e.dataText)throw new Error("displayText is required");E=e.dataValue,C=e.dataText,I=e.dataValue2,b=e.dataValue3,V=e.dataValue4}}function c(e,t){var l=document.createElement("div");l.id="shizzle-container-"+t,l.className="shizzlex",l.innerHTML="<ul class='shizzlex sz-pills'><li class='sz-search-box-container'><input type='text' placeholder=\""+F+"\" class='sz-search-box'/></li></ul><ul class='shizzlex sz-choices'></ul>",p(l,e)}function d(e){e&&(S.empty(),_.forEach(e,function(e){S.append("<li data-value='"+e[E]+"' data-value-2='"+e[I]+"' data-value-3='"+e[b]+"' data-value-4='"+e[V]+"'>"+e[C]+"</li>")}))}function h(){$(document).on("click","#shizzle-container-"+e+" .sz-pills li",function(e){var t={};t[E]=$(this).data("value"),t[C]=$(this).data("text"),t[I]=$(this).attr("data-value-2"),t[b]=$(this).attr("data-value-3"),t[V]=$(this).attr("data-value-4");var l=!0;$.isFunction(H)?H(t):l=H,l&&g.items.push(t),_.remove(g.pills,function(e){return e.value===t[E]}),$('[data-value="'+t[E]+'"]').remove(),d(_.sortBy(g.items,["text"])),y.focus(),R&&z(),k&&k()})}function f(e){var t=!1;_.forEach(g.filteredItems,function(l){l[E]===e[E]&&(t=!0)}),t||g.filteredItems.push(e)}function p(e,t){t.parentNode.insertBefore(e,t.nextSibling)}function z(){D&&(R=!0,0===g.pills.length?(g.$pillContainer.addClass(L),M&&m()):g.$pillContainer.removeClass(L))}function v(){var t=document.createElement("span");t.className="shizzlex sz-validation-message "+N,t.innerText=O,t.style.display="none",p(t,document.getElementById("shizzle-container-"+e))}function m(){$("."+N).show()}function x(){$("."+N).hide()}var g=this,e=e,y=null,S=null,w=null,C=null,E=null,I=null,b=null,V=null,q=null,T=!1,B=!1,P=null,k=null,A=null,D=!1,L=null,M=!1,N=null,O=null,R=!1,F="",H=!0;g.dataSource=null,g.items=[],g.filteredItems=[],g.pills=[],g.$pillContainer=null,function(){if(!e)throw new Error("id is required");if(!t)throw new Error("dataFields are required");r(t),l&&(q=l.data||null,T=l.itemsVisibleOnPageLoad||!1,P=l.onItemSelected||null,k=l.onPillRemoved||null,A=l.onItemsCleared||null,B=l.setToFocusOnPageLoad||!1,L=l.fieldErrorCss||null,D=l.isRequired||null,M=l.showValidationMessage||!1,N=l.validationMessageCss||nulll,O=l.validationMessageText||null,F=l.placeholder||"",H=l.shouldRepopulateOnRemove||!0),g.dataSource=_.sortBy(q,["text"]),g.items=_.cloneDeep(g.dataSource),c(document.getElementById(e),e),S=$("#shizzle-container-"+e).find(".sz-choices"),y=$("#shizzle-container-"+e).find(".sz-search-box"),g.$pillContainer=$("#shizzle-container-"+e).find(".sz-pills"),D&&M&&v(),T?S.show():S.hide(),B&&y.focus(),g.items&&d(g.items),i()}(),this.addPill=function(t){g.pills.push(t);var l=document.createElement("li");l.setAttribute("data-id",t.id),l.setAttribute("data-text",t.text),l.setAttribute("data-value",t.value),l.setAttribute("data-value-2",t.value2),l.setAttribute("data-value-3",t.value3),l.setAttribute("data-value-4",t.value4),l.className="sz-pill",l.innerHTML="<span>"+t.text+"</span><span class='sz-close sz-hairline'></span>",$(l).insertBefore($("#shizzle-container-"+e).find(".sz-search-box").parent()),w=$("#shizzle-container-"+e).find(".sz-pill"),_.remove(g.items,function(e){return e[E]===t.value}),R&&z(),D&&M&&x(),d(g.items)},this.clearData=function(){g.dataSource=null,g.items=null,g.pills.length=0,g.filteredItems.length=0,y.val(""),S.empty(),S.hide(),w&&w.remove(),A&&A()},this.populateWithData=function(e){g.dataSource=_.sortBy(e,["text"]),g.items=_.cloneDeep(g.dataSource),d(g.items)},this.validateControl=function(){z()}}var $=require("jquery"),_=require("lodash");Shizzle.prototype.getSelectedItems=function(){return this.pills},Shizzle.prototype.setSelectedItems=function(e){var t=this;_.forEach(e,function(e){t.addPill(e)})},Shizzle.prototype.clear=function(){this.clearData()},Shizzle.prototype.populate=function(e){this.populateWithData(e)},Shizzle.prototype.isValid=function(){return 0!==this.pills.length},Shizzle.prototype.fireValidation=function(){console.warn("fireValidation is deprecated since version 1.1.0 . Use validate() instead."),this.validateControl()},Shizzle.prototype.validate=function(){this.validateControl()},module.exports=Shizzle;